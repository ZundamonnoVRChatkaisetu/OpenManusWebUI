# 言語対応と出力最適化機能の使用ガイド

OpenManusWebUIに追加された言語対応と出力最適化機能について説明します。これらの機能により、より自然な多言語対応、わかりやすい出力フォーマット、自動ファイル生成が可能になりました。

## 1. 言語対応機能

### 概要
ユーザーからの入力テキストの言語を自動検出し、同じ言語で応答する機能が追加されました。現在、英語・日本語・中国語に対応しています。

### 使用方法

#### 自動言語検出
デフォルトでは、入力されたテキストの言語が自動的に検出され、同じ言語で応答します。特別な設定は不要です。

```bash
# 自動言語検出（デフォルト）
python main.py
```

#### 明示的な言語指定
特定の言語を使用したい場合は、`--language`オプションで指定できます。

```bash
# 言語を明示的に指定
python main.py --language ja  # 日本語
python main.py --language en  # 英語
python main.py --language zh  # 中国語
```

#### Webアプリケーションでの言語設定
Webアプリケーションモードでも同様の言語設定が適用されます。

```bash
python main.py --web --language ja
```

## 2. 出力最適化機能

### 概要
AIの思考プロセスと最終結果を明確に区別し、ユーザーにとって読みやすい形式で表示します。デフォルトでは思考プロセスは非表示になっています。

### 使用方法

#### 標準モード（思考プロセス非表示）
デフォルトでは、思考プロセスが非表示になり、最終結果のみが表示されます。これにより、クリーンな回答が得られます。

```bash
# 標準モード
python main.py
```

#### デバッグモード（思考プロセス表示）
開発やデバッグのために思考プロセスを表示したい場合は、`--show-thoughts`オプションを使用します。

```bash
# デバッグモード
python main.py --show-thoughts
```

## 3. ファイル自動生成機能

### 概要
アプリケーション設計やプロトタイプ開発などの要求を検出すると、自動的に関連ファイルを生成します。

### 対応ファイルタイプ
- アプリケーション設計書（Markdown形式）
- UIプロトタイプ（HTML/CSS形式）
- その他、コンテキストに応じた各種ファイル

### 使用方法

#### 自動生成モード（デフォルト）
デフォルトでは、適切なコンテキストを検出すると自動的にファイルが生成されます。

```bash
# 自動生成モード
python main.py
```

以下のようなプロンプトを入力すると、自動的にファイルが生成されます：
- 「簡単なTodoアプリを設計してください」
- 「eコマースサイトのプロトタイプを作成してください」

#### 自動生成の無効化
ファイルの自動生成を無効にしたい場合は、`--disable-auto-files`オプションを使用します。

```bash
# 自動生成を無効化
python main.py --disable-auto-files
```

## 4. 高度な使用例

### コマンドラインモードでの使用例

```bash
# 日本語で応答し、思考プロセスを表示、ファイル自動生成有効
python main.py --language ja --show-thoughts

# 英語で応答し、思考プロセス非表示、ファイル自動生成無効
python main.py --language en --disable-auto-files
```

### Webアプリケーションモードでの使用例

```bash
# 日本語で応答し、思考プロセス非表示（デフォルト）、ファイル自動生成有効
python main.py --web --language ja

# ログレベルをデバッグに設定し、中国語で応答
python main.py --web --language zh --log-level debug
```

## 5. トラブルシューティング

### 言語検出の問題
- テキストが短すぎると、言語を正確に検出できない場合があります。十分な長さの入力を提供するか、`--language`オプションで明示的に指定してください。
- 複数の言語が混在している場合、主要な言語が検出されます。

### ファイル生成の問題
- プロンプトに十分な情報がない場合、デフォルトのテンプレートが使用されます。具体的な要件を指定すると、より適切なファイルが生成されます。
- 生成されたファイルは実行中のディレクトリに保存されます。ファイル名の衝突に注意してください。

### 思考プロセス表示の問題
- `--show-thoughts`オプションを使用しても、非常に長い思考プロセスは要約されることがあります。詳細な思考プロセスが必要な場合は、プロンプトで明示的に要求してください。

## 6. カスタマイズ

より高度なカスタマイズが必要な場合は、以下のファイルを編集できます：

- `app/utils/language_utils.py`: 言語検出と多言語テンプレートの設定
- `app/utils/file_templates.py`: ファイルテンプレートの追加・編集
- `app/utils/output_formatter.py`: 出力フォーマットのカスタマイズ
- `app/agent/enhanced_manus.py`: エージェントの動作のカスタマイズ

## 7. よくある質問

### Q: 日本語で質問したのに英語で返答されることがあるのはなぜですか？
A: 短い質問や専門用語が多い場合、言語検出が正確でないことがあります。`--language ja`オプションを使用して明示的に日本語を指定してください。

### Q: 生成されたファイルはどこに保存されますか？
A: コマンドラインモードでは実行中のディレクトリに、Webモードではセッションのワークスペースディレクトリに保存されます。Webモードではファイル一覧から確認できます。

### Q: 自動生成されるファイルの種類を制限できますか？
A: 現在、個別のファイルタイプごとの制限はありませんが、`--disable-auto-files`オプションですべての自動生成を無効にできます。

---

これらの新機能により、OpenManusWebUIはより使いやすく、多様な言語に対応し、効率的にファイルを生成できるようになりました。ぜひお試しください！
